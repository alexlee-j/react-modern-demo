### 项目记忆归档

#### 用户偏好
1. 使用中文回答问题
2. 对于一些安全的命令，比如创建目录、初始化项目等不会造成破坏性影响的操作，可以自行执行，无需用户确认
3. 对于一些比较复杂的命令，提示用户手动执行
4. 记忆要进行归档，以便新会话能了解之前的记忆

#### 项目需求
- 项目目标是搭建一个通过可交互示例学习React 19的工程化教学平台，具备知识管理系统(KMS)功能
- 使用Next.js 15、React 19、Tailwind CSS、MDX 2.0
- 需要启用Rust编译器，支持混合渲染模式（SSG + ISR）和边缘函数支持文档服务
- 目录结构需符合规范，双屏学习界面，左侧实时演示，右侧同步文档
- 自动文档归档，示例与文档双向关联

#### 示例开发指南

### 1. 文件结构规范

每个示例都应遵循以下文件结构：
```
src/app/lab/[exampleId]/
├── page.tsx              # 页面布局
├── demo/                 # 示例组件目录
│   └── {exampleId}.tsx  # 示例组件实现
└── docs/                # 文档目录
    └── {exampleId}.mdx  # MDX 文档
```

### 2. 开发流程

1. **准备阶段**
   - 确定示例主题和难度级别
   - 在 `examples.json` 中添加示例元数据
   - 创建必要的目录结构

2. **组件开发**
   - 在 `demo/` 目录下创建示例组件
   - 确保组件是独立的，不依赖外部状态
   - 添加适当的类型定义和注释
   - 实现错误处理和加载状态

3. **文档编写**
   - 在 `docs/` 目录下创建 MDX 文档
   - 严格遵循文档系统规范
   - 确保代码示例可运行
   - 添加完整的使用说明和最佳实践

4. **质量检查**
   - 代码质量检查
   - 文档完整性检查
   - 交互功能测试
   - 移动端适配检查

### 3. 示例开发清单

#### 基础 Hooks
- [x] useState
- [x] useEffect
- [x] useContext
- [x] useReducer
- [ ] useCallback
- [ ] useMemo
- [ ] useRef

#### 进阶 Hooks
- [ ] useImperativeHandle
- [ ] useLayoutEffect
- [ ] useDebugValue
- [ ] useTransition
- [ ] useDeferredValue
- [ ] useId
- [ ] useSyncExternalStore
- [ ] useInsertionEffect

#### React 19 新特性
- [ ] use Hook
- [ ] 资源加载
- [ ] Suspense SSR
- [ ] 服务器动作
- [ ] 流式渲染
- [ ] 并发渲染
- [ ] 自动批处理
- [ ] React Server Components

#### 组件模式
- [ ] 受控组件
- [ ] 非受控组件
- [ ] 复合组件
- [ ] 高阶组件
- [ ] Render Props
- [ ] 组件设计模式
- [ ] Error Boundary
- [ ] Portal
- [ ] Fragments
- [ ] Refs 转发
- [ ] Context Provider/Consumer
- [ ] 动态导入组件

#### 状态管理
- [ ] Context + useReducer
- [ ] 状态提升
- [ ] 状态下推
- [ ] 状态分片
- [ ] 表单状态管理
- [ ] 异步状态管理
- [ ] 缓存状态管理
- [ ] 全局状态管理
- [ ] 状态持久化
- [ ] 状态回退/前进

#### 性能优化
- [ ] 组件懒加载
- [ ] 状态批量更新
- [ ] 列表优化
- [ ] 缓存策略
- [ ] 代码分割
- [ ] 预加载
- [ ] 防抖和节流
- [ ] 虚拟列表
- [ ] 图片优化
- [ ] Web Workers
- [ ] Service Workers

#### 数据获取
- [ ] useEffect 获取
- [ ] React Query
- [ ] SWR
- [ ] Suspense 数据获取
- [ ] 服务器组件
- [ ] GraphQL 集成
- [ ] REST API 集成
- [ ] WebSocket 集成
- [ ] 数据预取
- [ ] 数据缓存策略

#### 路由和导航
- [ ] 客户端路由
- [ ] 动态路由
- [ ] 路由守卫
- [ ] 路由过渡
- [ ] 嵌套路由
- [ ] 路由参数
- [ ] 路由钩子
- [ ] 路由懒加载

#### 测试和调试
- [ ] 单元测试
- [ ] 集成测试
- [ ] 性能测试
- [ ] React DevTools
- [ ] 错误追踪
- [ ] 快照测试
- [ ] 端到端测试
- [ ] 性能分析
- [ ] 内存泄漏检测
- [ ] 测试最佳实践

#### 无障碍性
- [ ] ARIA 属性
- [ ] 键盘导航
- [ ] 屏幕阅读器
- [ ] 颜色对比度
- [ ] 焦点管理
- [ ] 语义化 HTML
- [ ] 动画可访问性
- [ ] 表格编辑

#### 安全性
- [ ] XSS 防护
- [ ] CSRF 防护
- [ ] 输入验证
- [ ] 安全的数据传输
- [ ] 敏感信息处理
- [ ] 权限控制

#### 国际化
- [ ] 文本翻译
- [ ] 日期和时间格式
- [ ] 数字和货币格式
- [ ] RTL 支持
- [ ] 多语言路由

#### 动画和过渡
- [ ] CSS 过渡
- [ ] React Transition Group
- [ ] Framer Motion
- [ ] 动画性能优化
- [ ] 手势动画

#### 工程化实践
- [ ] TypeScript 集成
- [ ] ESLint 配置
- [ ] Prettier 配置
- [ ] Git Hooks
- [ ] CI/CD 流程
- [ ] 代码审查规范
- [ ] 版本管理策略
- [ ] 模块化设计
- [ ] 依赖管理
- [ ] 构建优化

#### 开发工具链
- [ ] Create React App
- [ ] Next.js
- [ ] Vite
- [ ] webpack 配置
- [ ] Babel 配置
- [ ] 开发环境配置
- [ ] 调试工具使用
- [ ] 性能分析工具
- [ ] 代码生成工具
- [ ] API 文档生成

#### 部署和运维
- [ ] 静态部署
- [ ] 服务器部署
- [ ] Docker 容器化
- [ ] 负载均衡
- [ ] CDN 配置
- [ ] HTTPS 配置
- [ ] 监控和告警
- [ ] 日志管理
- [ ] 备份和恢复
- [ ] 灾难恢复

#### 移动端适配
- [ ] 响应式设计
- [ ] 触摸事件处理
- [ ] 移动端性能优化
- [ ] PWA 支持
- [ ] App Shell 模型
- [ ] 离线功能
- [ ] 设备 API 使用
- [ ] 移动端调试

#### 设计系统集成
- [ ] 组件库使用
- [ ] 主题定制
- [ ] 样式组织
- [ ] 设计令牌
- [ ] 组件变体
- [ ] 布局系统
- [ ] 图标系统
- [ ] 动画系统

#### 数据可视化
- [ ] 图表集成
- [ ] 数据大屏
- [ ] 实时数据更新
- [ ] 交互式图表
- [ ] 地图集成
- [ ] SVG 动画
- [ ] Canvas 绘图
- [ ] WebGL 集成

#### 富文本编辑
- [ ] 编辑器集成
- [ ] 格式化工具
- [ ] 协同编辑
- [ ] 历史记录
- [ ] 文件上传
- [ ] 图片处理
- [ ] 表格编辑
- [ ] 公式编辑

#### 实时通信
- [ ] WebSocket
- [ ] Server-Sent Events
- [ ] 消息推送
- [ ] 实时协作
- [ ] 音视频通信
- [ ] 聊天功能
- [ ] 状态同步
- [ ] 离线消息

#### 错误处理和监控
- [ ] 错误边界
- [ ] 错误上报
- [ ] 性能监控
- [ ] 用户行为分析
- [ ] A/B 测试
- [ ] 特性开关
- [ ] 诊断工具
- [ ] 健康检查

#### 微前端
- [ ] 应用集成
- [ ] 路由管理
- [ ] 状态共享
- [ ] 样式隔离
- [ ] 通信机制
- [ ] 部署策略
- [ ] 版本控制
- [ ] 性能优化

### 4. 开发注意事项

1. **代码规范**
   - 使用 TypeScript 编写所有组件
   - 遵循函数式编程原则
   - 保持组件的纯函数特性
   - 使用 ESLint 和 Prettier 保持代码风格一致
   - 每个示例文件都应该有完整的类型定义

2. **性能考虑**
   - 合理使用 useMemo 和 useCallback
   - 避免不必要的重渲染
   - 大型列表考虑虚拟化
   - 合理设置依赖数组
   - 清理副作用以防止内存泄漏

3. **交互设计**
   - 每个示例都可以实际操作
   - 提供即时的视觉反馈
   - 展示多种使用场景
   - 添加错误处理示例
   - 展示常见的错误用法和解决方案

4. **文档要求**
   - 清晰说明示例的目的和使用场景
   - 提供完整的代码解释
   - 包含常见问题和解决方案
   - 添加相关的官方文档链接
   - 展示最佳实践和性能优化建议

5. **示例复杂度管理**
   - 从简单到复杂渐进展示
   - 每个复杂示例都应该有简化版本
   - 提供可选的进阶使用场景
   - 清晰标注难度级别
   - 说明前置知识要求

### 5. 文档模板

每个新示例都应该包含以下基本部分：

```markdown
---
exampleId: "示例ID"
title: "示例标题"
description: "示例描述"
difficulty: 1-5
category: "分类"
tags: ["相关标签"]
relatedComponents: ["相关组件路径"]
dependencies: ["依赖项"]
---

# 标题

## 为什么需要？
[说明使用场景和解决的问题]

## 核心概念
[解释关键概念和原理]

## 实现步骤
[代码示例和说明]

## 使用说明
[基本用法]

## 进阶用法
[高级特性]

## 注意事项
[常见问题和解决方案]

## 最佳实践
[推荐用法和反面示例]

## 相关资源
[学习资源和文档链接]

## 下一步学习
[学习路径建议]
```

### 6. 开发优先级

1. **第一阶段：基础 Hooks**
   - useState 
   - useEffect
   - useContext
   - useReducer

2. **第二阶段：组件模式**
   - 受控组件
   - 复合组件
   - 高阶组件

3. **第三阶段：状态管理**
   - Context 集成
   - 状态管理模式

4. **第四阶段：性能优化**
   - 性能优化技巧
   - 最佳实践示例

### 7. 质量保证

每个示例发布前必须：
1. 通过所有 TypeScript 类型检查
2. 通过 ESLint 检查
3. 确保文档完整性
4. 测试所有示例代码
5. 检查移动端适配
6. 验证可访问性要求

### 8. 更新记录

- 2025-02-16: 完成 useState 示例和文档
- [后续更新记录...]

### 9. 示例代码开发经验

#### 示例代码最佳实践
1. **组件结构**
   - 每个示例独立封装成组件
   - 相关的示例组合在一起
   - 使用语义化的组件命名

2. **文档集成**
   - 说明文字直接集成在组件中
   - 关键代码片段随示例展示
   - 避免分散的文档维护

3. **交互设计**
   - 每个示例都可以实际操作
   - 提供即时的视觉反馈
   - 展示多种使用场景

4. **代码展示**
   - 使用代码块展示关键实现
   - 添加必要的代码注释
   - 保持代码片段简洁

5. **HTML 结构**
   - 遵循 HTML 语义化规范
   - 正确的标签嵌套关系
   - 合理使用 ARIA 属性

6. **样式规范**
   - 统一使用 Tailwind CSS
   - 保持组件间视觉一致性
   - 响应式设计适配

7. **性能考虑**
   - 合理使用状态管理
   - 避免不必要的渲染
   - 优化加载性能

#### 常见问题及解决方案

1. **文档与代码同步**
   - 问题：文档和代码容易出现不一致
   - 解决：将文档直接集成在示例组件中，确保同步更新

2. **代码可读性**
   - 问题：示例代码过于复杂难以理解
   - 解决：拆分成多个简单的子示例，每个聚焦一个要点

3. **交互体验**
   - 问题：用户难以理解示例的用途
   - 解决：添加清晰的说明和可交互的演示

4. **HTML 规范**
   - 问题：HTML 结构不符合规范
   - 解决：严格遵循 HTML 语义化规则，正确使用标签

#### 开发流程改进

1. **示例规划**
   - 先规划示例的知识点
   - 设计合适的交互方式
   - 准备相关的代码片段

2. **组件开发**
   - 实现核心功能
   - 添加说明文档
   - 集成代码展示

3. **质量检查**
   - 验证功能完整性
   - 检查代码规范
   - 测试交互体验

4. **持续优化**
   - 收集用户反馈
   - 优化交互体验
   - 更新示例内容

### 10. 技术债务记录

1. **需要优化的部分**
   - [ ] 统一所有示例的样式风格
   - [ ] 添加更多的错误处理示例
   - [ ] 优化移动端的显示效果

2. **待解决的问题**
   - [ ] 改进代码高亮显示
   - [ ] 添加示例搜索功能
   - [ ] 实现示例之间的关联导航

3. **未来计划**
   - [ ] 添加单元测试
   - [ ] 实现示例评分系统
   - [ ] 支持用户反馈功能

### 11. 更新日志

#### 2025-02-16
- 完善了 useState 示例的实现
- 优化了示例代码的展示方式
- 改进了文档与代码的集成方案
- 修复了 HTML 结构问题

#### 待完成任务
- [ ] 实现 useEffect 示例
- [ ] 实现 useContext 示例
- [ ] 实现 useReducer 示例
- [ ] 补充更多的高级用法示例

### 12. 代码展示优化记录

#### 实现方案
1. **技术选型**
   - 选择 react-syntax-highlighter 作为代码高亮方案
   - 使用 VSCode Dark Plus 主题提供专业的代码展示效果
   - 支持 TypeScript 语法高亮

2. **组件封装**
   - 创建统一的 Markdown 组件
   - 支持自定义样式扩展
   - 保持组件的可复用性

3. **性能优化**
   - 按需加载语法高亮库
   - 优化代码块渲染性能
   - 减少不必要的重渲染

#### 最佳实践总结

1. **代码展示**
   ```typescript
   // ✅ 推荐的代码展示方式
   const codeString = `const [state, setState] = useState(initialValue);
   // 更新状态说明
   setState(newValue);`;

   return <Markdown>{codeString}</Markdown>;

   // ❌ 不推荐的方式
   return <code>{`const [state, setState] = useState(initialValue);`}</code>;
   ```

2. **样式处理**
   ```typescript
   // ✅ 推荐的样式处理
   <Markdown className="bg-gray-50 p-3 rounded" />

   // ❌ 不推荐使用内联样式
   <div style={{ background: '#f7f7f7', padding: '12px' }}>
     <code>...</code>
   </div>
   ```

3. **组件复用**
   ```typescript
   // ✅ 推荐的组件封装
   interface MarkdownProps {
     children: string;
     className?: string;
   }

   // ❌ 避免重复实现代码高亮逻辑
   const CodeBlock = ({ code }) => {
     // 重复的高亮实现...
   };
   ```

#### 遇到的问题及解决方案

1. **样式冲突**
   - 问题：Markdown 样式与全局样式冲突
   - 解决：使用独立的样式作用域，避免样式污染

2. **代码换行**
   - 问题：长代码行显示不完整
   - 解决：添加适当的换行和缩进，保持代码可读性

3. **响应式适配**
   - 问题：移动端代码展示效果不佳
   - 解决：添加响应式样式，优化移动端显示

#### 后续优化计划

1. **功能增强**
   - [ ] 添加代码复制功能
   - [ ] 支持多种主题切换
   - [ ] 添加行号显示

2. **性能优化**
   - [ ] 实现代码分割
   - [ ] 优化首次加载时间
   - [ ] 添加加载占位符

3. **用户体验**
   - [ ] 添加语法错误提示
   - [ ] 支持代码折叠
   - [ ] 优化代码搜索功能

### 13. 开发规范补充

#### 1. 文档文件位置
- MDX 文档文件应放在 `src/app/lab/[exampleId]/docs/` 目录下
- 文档文件名应与示例 ID 保持一致，如 `use-state.mdx`
- 不要在 docs 目录下创建子目录
- 确保文档与示例代码在对应的目录中

#### 2. 示例顺序管理
- 新示例应添加到 `examples` 数组的末尾
- 保持示例的渐进性，从基础到高级
- 示例顺序：
  1. 基础 Hooks（useState、useEffect 等）
  2. 进阶 Hooks（useContext、useReducer 等）
  3. 性能优化（useMemo、useCallback）
  4. 自定义 Hooks
  5. 实践模式（Suspense、ErrorBoundary 等）

#### 3. 目录结构规范
```bash
/src
├─ app/
│  ├─ lab/               
│  │  ├─ [exampleId]/    
│  │  │  ├─ demo/        # 示例组件（客户端组件）
│  │  │  ├─ docs/        # 自动加载对应MDX文档
│  │  │  │  ├─ use-state.mdx
│  │  │  │  ├─ use-effect.mdx
│  │  │  ├─ page.tsx     # 双栏布局控制器
```

### 14. 更新日志

#### 2025-02-16
- 添加了 useEffect 示例和文档
- 规范了文档文件位置
- 规范了示例顺序管理
- 更新了首页示例列表

#### 待完成任务
- [ ] 完善文档的 YAML 头信息
- [ ] 添加更多 React Hooks 示例
- [ ] 实现交互式代码沙盒
