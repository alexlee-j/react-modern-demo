# useFormStatus Hook è¯¦è§£ ğŸ¨

## åŸºæœ¬æ¦‚å¿µ

useFormStatus æ˜¯ React æä¾›çš„ä¸€ä¸ªç”¨äºå¤„ç†è¡¨å•æäº¤çŠ¶æ€çš„ Hookã€‚å®ƒèƒ½å¤Ÿï¼š

- ğŸ”„ è¿½è¸ªè¡¨å•æäº¤çŠ¶æ€
- âš¡ æä¾›åŠ è½½çŠ¶æ€åé¦ˆ
- ğŸ¯ ä¼˜åŒ–è¡¨å•äº¤äº’ä½“éªŒ

## ä½¿ç”¨åœºæ™¯

### 1. è¡¨å•æäº¤çŠ¶æ€ç®¡ç†

å½“éœ€è¦åœ¨è¡¨å•æäº¤è¿‡ç¨‹ä¸­æä¾›è§†è§‰åé¦ˆæ—¶ï¼š

```jsx
import { useFormStatus } from 'react-dom';

function SubmitButton() {
  const { pending } = useFormStatus();
  
  return (
    <button 
      disabled={pending}
      className={`btn ${pending ? 'opacity-50' : ''}`}
    >
      {pending ? 'æäº¤ä¸­...' : 'æäº¤'}
    </button>
  );
}

function Form() {
  async function handleSubmit(formData) {
    'use server';
    await new Promise(resolve => setTimeout(resolve, 2000));
  }

  return (
    <form action={handleSubmit}>
      <input type="text" name="username" />
      <SubmitButton />
    </form>
  );
}
```

### 2. åŠ è½½çŠ¶æ€æŒ‡ç¤º

åœ¨è¡¨å•æäº¤è¿‡ç¨‹ä¸­æ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼š

```jsx
import { useFormStatus } from 'react-dom';

function LoadingSpinner() {
  const { pending } = useFormStatus();
  
  if (!pending) return null;
  
  return (
    <div className="loading-spinner" role="status">
      <div className="spinner-border">
        <span className="sr-only">åŠ è½½ä¸­...</span>
      </div>
    </div>
  );
}
```

### 3. è¡¨å•å­—æ®µæ§åˆ¶

åœ¨æäº¤è¿‡ç¨‹ä¸­ç¦ç”¨è¡¨å•å­—æ®µï¼š

```jsx
import { useFormStatus } from 'react-dom';

function FormFields() {
  const { pending } = useFormStatus();
  
  return (
    <fieldset disabled={pending}>
      <input type="text" name="username" placeholder="ç”¨æˆ·å" />
      <input type="password" name="password" placeholder="å¯†ç " />
      <select name="role">
        <option value="user">æ™®é€šç”¨æˆ·</option>
        <option value="admin">ç®¡ç†å‘˜</option>
      </select>
    </fieldset>
  );
}
```

## æ€§èƒ½è€ƒè™‘ âš ï¸

useFormStatus çš„ä½¿ç”¨éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

1. ğŸ¯ **ç»„ä»¶ç²’åº¦**: å°†ä½¿ç”¨ useFormStatus çš„ç»„ä»¶å°½å¯èƒ½å°ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
2. ğŸ’¡ **çŠ¶æ€æå‡**: ä¸è¦åœ¨è¡¨å•å®¹å™¨ç»„ä»¶ä¸­ç›´æ¥ä½¿ç”¨ï¼Œè€Œæ˜¯åœ¨ä¸“é—¨çš„å­ç»„ä»¶ä¸­ä½¿ç”¨
3. ğŸ”„ **æ›´æ–°é¢‘ç‡**: pending çŠ¶æ€çš„å˜åŒ–ä¼šè§¦å‘ç»„ä»¶é‡æ¸²æŸ“ï¼Œæ³¨æ„æ§åˆ¶ä½¿ç”¨èŒƒå›´

## æœ€ä½³å®è·µ

### 1. ç»„ä»¶åˆ†ç¦»

```jsx
// âœ… å¥½ï¼šå°†çŠ¶æ€ç»„ä»¶åˆ†ç¦»
function SubmitButton() {
  const { pending } = useFormStatus();
  return <button disabled={pending}>æäº¤</button>;
}

// âŒ å·®ï¼šåœ¨è¡¨å•ç»„ä»¶ä¸­ç›´æ¥ä½¿ç”¨
function Form() {
  const { pending } = useFormStatus(); // è¿™æ ·ä½¿ç”¨æ˜¯é”™è¯¯çš„
  return <form>...</form>;
}
```

### 2. é”™è¯¯å¤„ç†

```jsx
function FormWithErrorHandling() {
  const { pending } = useFormStatus();
  const [error, setError] = useState(null);

  useEffect(() => {
    if (!pending && error) {
      toast.error(error);
    }
  }, [pending, error]);

  return <form>...</form>;
}
```

### 3. å¯è®¿é—®æ€§

```jsx
function AccessibleForm() {
  const { pending } = useFormStatus();
  
  return (
    <form aria-busy={pending}>
      <button
        aria-disabled={pending}
        disabled={pending}
      >
        æäº¤
      </button>
    </form>
  );
}
```

## å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆæˆ‘çš„ useFormStatus æ€»æ˜¯è¿”å› undefinedï¼Ÿ

A: useFormStatus åªèƒ½åœ¨è¡¨å•ç»„ä»¶å†…éƒ¨ä½¿ç”¨ï¼Œå¹¶ä¸”å¿…é¡»æ˜¯ç”± form action è§¦å‘çš„æäº¤æ“ä½œã€‚ç¡®ä¿ä½ çš„ç»„ä»¶æ˜¯ä½œä¸º form å…ƒç´ çš„å­ç»„ä»¶ã€‚

### Q2: useFormStatus å’Œ useState æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

A: useFormStatus ä¸“é—¨ç”¨äºå¤„ç†è¡¨å•æäº¤çŠ¶æ€ï¼Œè€Œ useState æ˜¯é€šç”¨çš„çŠ¶æ€ç®¡ç† Hookã€‚useFormStatus ä¼šè‡ªåŠ¨è·Ÿè¸ªè¡¨å•çš„æäº¤çŠ¶æ€ï¼Œä¸éœ€è¦æ‰‹åŠ¨æ›´æ–°ã€‚

### Q3: å¦‚ä½•åœ¨æœåŠ¡å™¨ç»„ä»¶ä¸­ä½¿ç”¨ useFormStatusï¼Ÿ

A: useFormStatus æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯ Hookï¼Œä¸èƒ½åœ¨æœåŠ¡å™¨ç»„ä»¶ä¸­ç›´æ¥ä½¿ç”¨ã€‚ä½ éœ€è¦å°†ä½¿ç”¨ useFormStatus çš„é€»è¾‘æŠ½ç¦»åˆ°å®¢æˆ·ç«¯ç»„ä»¶ä¸­ã€‚

### Q4: å¦‚ä½•ä¼˜åŒ–ä½¿ç”¨ useFormStatus çš„æ€§èƒ½ï¼Ÿ

A: ä¼˜åŒ– useFormStatus æ€§èƒ½çš„å…³é”®ç‚¹ï¼š
1. å°†ä½¿ç”¨ useFormStatus çš„ç»„ä»¶å°½å¯èƒ½å°ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
2. ä¸è¦åœ¨è¡¨å•å®¹å™¨ç»„ä»¶ä¸­ç›´æ¥ä½¿ç”¨
3. ä½¿ç”¨ memo ä¼˜åŒ–å­ç»„ä»¶
4. é¿å…åœ¨ pending çŠ¶æ€å˜åŒ–æ—¶è¿›è¡Œå¤æ‚è®¡ç®—

## ç›¸å…³èµ„æº

- [React å®˜æ–¹æ–‡æ¡£ï¼šuseFormStatus](https://react.dev/reference/react-dom/hooks/useFormStatus)
- [è¡¨å•å¤„ç†æœ€ä½³å®è·µ](https://react.dev/learn/managing-form-state)
- [React Server Actions](https://react.dev/reference/react/use-server)

## ä¸‹ä¸€æ­¥å­¦ä¹ 

- useOptimisticï¼šå­¦ä¹ å¦‚ä½•å®ç°ä¹è§‚æ›´æ–°
- useTransitionï¼šäº†è§£å¦‚ä½•å¤„ç†çŠ¶æ€è½¬æ¢
- Server Actionsï¼šæ·±å…¥å­¦ä¹ æœåŠ¡å™¨ç«¯æ“ä½œ