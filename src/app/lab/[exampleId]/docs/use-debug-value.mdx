# useDebugValue ç¤ºä¾‹

## åŸºæœ¬ä»‹ç»

useDebugValue æ˜¯ React æä¾›çš„ä¸€ä¸ªç”¨äºè°ƒè¯•çš„ Hookï¼Œå®ƒå¯ä»¥åœ¨ React DevTools ä¸­ä¸ºè‡ªå®šä¹‰ Hook æ·»åŠ æ ‡ç­¾ã€‚è¿™ä¸ª Hook ä¸»è¦ç”¨äºå¼€å‘é˜¶æ®µï¼Œå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç†è§£å’Œè°ƒè¯•è‡ªå®šä¹‰ Hook çš„çŠ¶æ€ã€‚

## åŸºç¡€ç”¨æ³•

### ç®€å•çš„è°ƒè¯•æ ‡ç­¾

```tsx
import { useDebugValue, useState } from "react";

function useOnlineStatus() {
  const [isOnline, setIsOnline] = useState(true);

  // åœ¨ React DevTools ä¸­æ˜¾ç¤ºå½“å‰çŠ¶æ€
  useDebugValue(isOnline ? "åœ¨çº¿" : "ç¦»çº¿");

  return isOnline;
}

export default function OnlineStatus() {
  const isOnline = useOnlineStatus();

  return <div>å½“å‰çŠ¶æ€: {isOnline ? "ğŸŸ¢ åœ¨çº¿" : "ğŸ”´ ç¦»çº¿"}</div>;
}
```

### æ¡ä»¶æ ¼å¼åŒ–

æœ‰æ—¶å€™ï¼Œæ ¼å¼åŒ–è°ƒè¯•å€¼çš„æ“ä½œå¯èƒ½ä¼šå¾ˆæ˜‚è´µã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ªæ ¼å¼åŒ–å‡½æ•°ä½œä¸º useDebugValue çš„ç¬¬äºŒä¸ªå‚æ•°ï¼š

```tsx
import { useDebugValue, useState } from "react";

function useDataFetcher(url: string) {
  const [data, setData] = useState<any>(null);

  // æ ¼å¼åŒ–å‡½æ•°åªåœ¨ React DevTools æ‰“å¼€æ—¶æ‰ä¼šè°ƒç”¨
  useDebugValue(data, (data) => {
    if (!data) return "åŠ è½½ä¸­...";
    return `æ•°æ®å¤§å°: ${JSON.stringify(data).length} å­—èŠ‚`;
  });

  // ... æ•°æ®è·å–é€»è¾‘

  return data;
}

export default function DataViewer() {
  const data = useDataFetcher("https://api.example.com/data");

  return (
    <div>
      {data ? <pre>{JSON.stringify(data, null, 2)}</pre> : <p>åŠ è½½ä¸­...</p>}
    </div>
  );
}
```

### æ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹

åœ¨å¤æ‚çš„è‡ªå®šä¹‰ Hook ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç»“åˆä½¿ç”¨ useDebugValue å’Œå…¶ä»–æ€§èƒ½ä¼˜åŒ–æŠ€å·§ï¼š

```tsx
import { useDebugValue, useMemo, useState } from "react";

function useExpensiveCalculation(value: number) {
  const [result, setResult] = useState<number>(0);

  // ä½¿ç”¨ useMemo ç¼“å­˜è®¡ç®—ç»“æœ
  const calculation = useMemo(() => {
    const start = performance.now();
    // æ¨¡æ‹Ÿå¤æ‚è®¡ç®—
    const calculatedValue = Array(value)
      .fill(0)
      .reduce((acc) => acc + Math.random(), 0);
    const end = performance.now();

    return {
      value: calculatedValue,
      time: end - start,
    };
  }, [value]);

  // ä½¿ç”¨æ ¼å¼åŒ–å‡½æ•°å»¶è¿Ÿè°ƒè¯•å€¼çš„æ ¼å¼åŒ–
  useDebugValue(calculation, (calc) => {
    return `è®¡ç®—ç»“æœ: ${calc.value.toFixed(2)} (è€—æ—¶: ${calc.time.toFixed(
      2
    )}ms)`;
  });

  return calculation.value;
}

export default function Calculator() {
  const [input, setInput] = useState(1000);
  const result = useExpensiveCalculation(input);

  return (
    <div>
      <input
        type="number"
        value={input}
        onChange={(e) => setInput(Number(e.target.value))}
        min="0"
        max="10000"
      />
      <p>è®¡ç®—ç»“æœ: {result.toFixed(2)}</p>
    </div>
  );
}
```

## æœ€ä½³å®è·µ

1. ä»…åœ¨è‡ªå®šä¹‰ Hook ä¸­ä½¿ç”¨ useDebugValue

```tsx
// âœ… å¥½ï¼šåœ¨è‡ªå®šä¹‰ Hook ä¸­ä½¿ç”¨
function useCustomHook() {
  useDebugValue("debug info");
}

// âŒ å·®ï¼šåœ¨æ™®é€šç»„ä»¶ä¸­ä½¿ç”¨
function Component() {
  useDebugValue("debug info"); // ä¸å¿…è¦
}
```

2. ä½¿ç”¨æ ¼å¼åŒ–å‡½æ•°ä¼˜åŒ–æ€§èƒ½

```tsx
// âœ… å¥½ï¼šä½¿ç”¨æ ¼å¼åŒ–å‡½æ•°å»¶è¿Ÿè®¡ç®—
useDebugValue(data, (data) => expensiveOperation(data));

// âŒ å·®ï¼šç›´æ¥è¿›è¡Œæ˜‚è´µçš„è®¡ç®—
useDebugValue(expensiveOperation(data));
```

3. æä¾›æœ‰æ„ä¹‰çš„è°ƒè¯•ä¿¡æ¯

```tsx
// âœ… å¥½ï¼šæä¾›æœ‰ç”¨çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
useDebugValue(isLoading ? "åŠ è½½ä¸­" : `å·²åŠ è½½ ${items.length} é¡¹`);

// âŒ å·®ï¼šä¿¡æ¯è¿‡äºç®€å•
useDebugValue(items);
```

## å¸¸è§é—®é¢˜

<FAQ
  questions={[
    {
      q: "useDebugValue ä¼šå½±å“ç”Ÿäº§ç¯å¢ƒçš„æ€§èƒ½å—ï¼Ÿ",
      a: "ä¸ä¼šã€‚useDebugValue ä»…åœ¨å¼€å‘å·¥å…·ï¼ˆReact DevToolsï¼‰æ‰“å¼€æ—¶æ‰ä¼šæ‰§è¡Œæ ¼å¼åŒ–å‡½æ•°ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¸ä¼šäº§ç”Ÿä»»ä½•æ€§èƒ½å¼€é”€ã€‚"
    },
    {
      q: "ä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨ useDebugValueï¼Ÿ",
      a: "å½“ä½ åˆ›å»ºå¯å¤ç”¨çš„è‡ªå®šä¹‰ Hook æ—¶ï¼Œç‰¹åˆ«æ˜¯åœ¨åº“ä¸­çš„ Hookï¼Œä½¿ç”¨ useDebugValue å¯ä»¥å¸®åŠ©å…¶ä»–å¼€å‘è€…æ›´å¥½åœ°ç†è§£å’Œè°ƒè¯•ä½ çš„ Hookã€‚å¯¹äºåº”ç”¨å†…éƒ¨çš„ç®€å• Hookï¼Œé€šå¸¸ä¸éœ€è¦ä½¿ç”¨ useDebugValueã€‚"
    },
    {
      q: "å¯ä»¥åœ¨ä¸€ä¸ª Hook ä¸­å¤šæ¬¡è°ƒç”¨ useDebugValue å—ï¼Ÿ",
      a: "å¯ä»¥ï¼Œä½†å»ºè®®ä¿æŒé€‚åº¦ã€‚æ¯ä¸ª useDebugValue è°ƒç”¨éƒ½ä¼šåœ¨ DevTools ä¸­æ˜¾ç¤ºä¸€ä¸ªæ ‡ç­¾ï¼Œè¿‡å¤šçš„è°ƒè¯•å€¼å¯èƒ½ä¼šä½¿è°ƒè¯•ç•Œé¢å˜å¾—æ··ä¹±ã€‚"
    },
    {
      q: "å¦‚ä½•åœ¨ TypeScript ä¸­æ­£ç¡®ä½¿ç”¨ useDebugValueï¼Ÿ",
      a: "åœ¨ TypeScript ä¸­ä½¿ç”¨ useDebugValue æ—¶ï¼Œå»ºè®®ä¸ºæ ¼å¼åŒ–å‡½æ•°æä¾›æ˜ç¡®çš„ç±»å‹æ³¨è§£ï¼Œä»¥ç¡®ä¿ç±»å‹å®‰å…¨ï¼š\n```typescript\nuseDebugValue<T>(value: T, format: (value: T) => string);\n```"
    },
    {
      q: "useDebugValue çš„æ ¼å¼åŒ–å‡½æ•°ä»€ä¹ˆæ—¶å€™ä¼šè¢«è°ƒç”¨ï¼Ÿ",
      a: "æ ¼å¼åŒ–å‡½æ•°ä»…åœ¨ React DevTools å®é™…éœ€è¦æ˜¾ç¤ºè°ƒè¯•å€¼æ—¶æ‰ä¼šè¢«è°ƒç”¨ã€‚è¿™ç§å»¶è¿Ÿæ‰§è¡Œçš„è®¾è®¡å¯ä»¥é¿å…åœ¨ä¸éœ€è¦æ—¶æ‰§è¡Œæ˜‚è´µçš„æ ¼å¼åŒ–æ“ä½œã€‚"
    }
  ]}
/>

## ç›¸å…³èµ„æº

- [React å®˜æ–¹æ–‡æ¡£ï¼šuseDebugValue](https://react.dev/reference/react/useDebugValue)
- [React DevTools è°ƒè¯•æŒ‡å—](https://react.dev/learn/react-developer-tools)

## ä¸‹ä¸€æ­¥å­¦ä¹ 

- useIdï¼šå­¦ä¹ å¦‚ä½•ç”Ÿæˆå”¯ä¸€æ ‡è¯†ç¬¦
- useDeferredValueï¼šå­¦ä¹ å¦‚ä½•å¤„ç†å»¶è¿ŸåŠ è½½çš„å€¼
- useTransitionï¼šå­¦ä¹ å¦‚ä½•å¤„ç†çŠ¶æ€è½¬æ¢
